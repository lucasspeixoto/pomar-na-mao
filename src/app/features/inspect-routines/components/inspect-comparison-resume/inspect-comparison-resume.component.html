@let isLoadingRoutinePlants = inspectRoutinePlantsService.isLoading();

@let isLoadingCurrentPlant = plantsService.isLoading();

@let currentSelectedPlantInComparison =
plantsService.selectedPlantInComparison();

@let updatedSelectedPlantInComparison =
inspectRoutinePlantsService.selectedPlantInComparison();

@if(isLoadingRoutinePlants || isLoadingCurrentPlant) {
<app-inspect-comparison-resume-skeleton />
} @else {
@if(inspectRoutineService.isComparisonActive()) {
<div class="flex flex-col h-full px-4 pt-4 pb-2 ">
    <span class="text-gray-800 text-lg font-semibold dark:text-white/80">Planta
        #{{currentSelectedPlantInComparison?.id!.split('-')[0]}}</span>
    <div class="my-2 flex w-full h-full justify-center items-center">
        <img width="80" height="80" src="/images/plants/lichia.png"
            alt="Imagem Pé Lichia" />
        <div
            class="h-[120px] w-full flex flex-col justify-center self-start gap-4 ml-2 my-2">
            <p
                class="text-gray-800 text-md font-medium dark:text-white/80">Diferenças:
                <span
                    class="text-brand-500 font-bold">
                @if(numberOfDifferences > 0) {
                    {{numberOfDifferences}}
                } @else {
                    Nenhuma
                }
                </span></p>
            @if(currentSelectedPlantInComparison?.last_work) {
            <p
                class="text-gray-800 text-md font-medium dark:text-white/80">Atualizado:
                <span
                    class="text-brand-500 font-bold">{{currentSelectedPlantInComparison?.last_work
                    | date: 'dd/MM/yyyy'}}</span>
            </p>
            } @else {
                <p
                class="text-gray-800 text-md font-medium dark:text-white/80">Atualizado:
                <span
                    class="text-brand-500 font-bold">Nunca</span>
            </p>
            }

            <!-- Status -->
            <div class="flex items-center">
                @if(updatedSelectedPlantInComparison?.is_approved) {
                <span
                    class="px-3 py-2 rounded-full text-xs font-semibold bg-green-100 text-green-700 border border-green-300">
                    Aprovado
                </span>
                } @else {
                <span
                    class="px-3 py-2 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-700 border border-yellow-300">
                    Pendente
                </span>
                }
            </div>
        </div>
    </div>

    <app-button (btnClick)="approvePlantInspectUpdates()"
        [disabled]="updatedSelectedPlantInComparison?.is_approved!"
        className="w-full mb-2 " variant="primary" size="md">
        Aprovar
    </app-button>

</div>
} @else {
<div class="flex flex-col justify-between items-center gap-4 h-full pt-4 pb-2">
    <img width="150" height="150"
        src="/images/plants/black_and_white_lichie.png" alt="404" />
    <app-button (btnClick)="startRoutineComparison()" className="w-full mb-2"
        size="sm">
        Iniciar
    </app-button>
</div>
}
}
